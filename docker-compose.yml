# ============================================
# Hyperliquid Trading Bot - Docker Compose (H2)
# ============================================
# Usage:
#   Start:  docker compose up -d --build
#   Logs:   docker compose logs -f app
#   Stop:   docker compose down

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: hyperliquid-bot
    ports:
      - "${SERVER_PORT:-8080}:8080"
    environment:
      # Spring Profile - use local for H2
      - SPRING_PROFILES_ACTIVE=local
      # JWT
      - JWT_SECRET=${JWT_SECRET:-Y29tcGxleF9qd3Rfc2VjcmV0X2tleV9mb3JfaHlwZXJsaXF1aWRfYm90XzIwMjVfcG9jX3ZlcnlfbG9uZ19zZWN1cmVfc3RyaW5n}
      - JWT_EXPIRATION=${JWT_EXPIRATION:-86400000}
      # JVM - increase memory for container
      - JAVA_OPTS=${JAVA_OPTS:--Xms384m -Xmx768m}
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-sf", "http://localhost:8080/actuator/health"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 120s
